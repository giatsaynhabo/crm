<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ‘¥ Quáº£n lÃ½ NhÃ¢n viÃªn & Cá»­a hÃ ng</title>
  <link rel="stylesheet" href="css/style.css" />

  <!-- â›” áº¨n trang cho Ä‘áº¿n khi kiá»ƒm tra quyá»n xong -->
  <style>
    .left-tools {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    /* NÃºt ThÃªm nhÃ¢n viÃªn */
#btnOpenAddNV {
  background: #007bff; /* xanh dÆ°Æ¡ng */
  color: #fff;
}
#btnOpenAddNV:hover {
  background: #0062cc;
}

/* NÃºt ThÃªm cá»­a hÃ ng */
#btnOpenAddCH {
  background: #067833; /* cam */
  color: #fff;
}
#btnOpenAddCH:hover {
  background: #e67600;
}

/* NÃºt Danh sÃ¡ch cá»­a hÃ ng */
#btnListCH {
  background: #6c757d; /* xÃ¡m */
  color: #fff;
}
#btnListCH:hover {
  background: #5a6268;
}

/* NÃºt Khai bÃ¡o vá»‹ trÃ­ kho */
#btnOpenKhaiBaoVT {
  background: #28a745; /* xanh lÃ¡ */
  color: #fff;
}
#btnOpenKhaiBaoVT:hover {
  background: #218838;
}

/* Tá»‘i Æ°u layout nÃºt */
.left-tools button {
  padding: 10px 18px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.2s ease;
}

  </style>

  <!-- ğŸ”’ Kiá»ƒm tra Ä‘Äƒng nháº­p + quyá»n truy cáº­p trang -->
  <script type="module">
    import { initProtectedPage } from "./js/permissionInit.js";
    // âœ… Gá»i hÃ m khá»Ÿi táº¡o báº£o vá»‡ trang: (key, action)
    await initProtectedPage("nhanvienManage", "view");
  </script>

  <script type="module" src="js/firebaseConfig.js" defer></script>
  <script type="module" src="js/menu.js" defer></script>
  <script type="module" src="js/nhanvien.js" defer></script>
</head>

<body>
  <div id="menu"></div>

  <main class="container">
    <h1>ğŸ‘¥ Quáº£n lÃ½ NhÃ¢n viÃªn & Cá»­a hÃ ng</h1>

    <div class="toolbar">
      <div class="left-tools">
        <button id="btnOpenAddNV" class="btn-add"
                data-permission-key="nhanvienManage"
                data-permission-action="create">â• ThÃªm nhÃ¢n viÃªn</button>

        <button id="btnOpenAddCH" class="btn-add orange"
                data-permission-key="cuaHangManage"
                data-permission-action="create">ğŸª ThÃªm cá»­a hÃ ng</button>

        <button id="btnListCH" class="btn-add gray"
                data-permission-key="cuaHangManage"
                data-permission-action="view">ğŸ“‹ Danh sÃ¡ch cá»­a hÃ ng</button>

        <button id="btnOpenKhaiBaoVT" class="btn-add green"
                data-permission-key="viTriKhoManage"
                data-permission-action="create">ğŸ“¦ Khai bÃ¡o vá»‹ trÃ­ kho</button>
      </div>

      <div class="search-area">
        <input type="text" id="searchInput" placeholder="TÃ¬m theo tÃªn hoáº·c SÄT..." 
               data-permission-key="nhanvienManage"
               data-permission-action="search"/>
        <button id="btnSearch" class="btn-save"
                data-permission-key="nhanvienManage"
                data-permission-action="search">TÃ¬m</button>
        <button id="btnClear" class="btn-cancel"
                data-permission-key="nhanvienManage"
                data-permission-action="search">XÃ³a</button>
      </div>
    </div>

    <table class="data-table">
      <thead>
        <tr style="background:#f4f6f8;">
          <th>User</th>
          <th>Há» tÃªn</th>
          <th>SÄT</th>
          <th>Äá»‹a chá»‰</th>
          <th>Giá»›i tÃ­nh</th>
          <th>Quyá»n</th>
          <th>Chá»©c vá»¥</th>
          <th>TÃ¬nh tráº¡ng</th>
          <th>Kho lÃ m viá»‡c</th>
          <th>HÃ nh Ä‘á»™ng</th>
        </tr>
      </thead>
      <tbody id="listNhanVien"></tbody>
    </table>
  </main>

  <!-- ğŸ§© Modal thÃªm nhÃ¢n viÃªn -->
  <div id="modalAddNV" class="modal">
    <div class="modal-content">
      <h2>â• ThÃªm nhÃ¢n viÃªn</h2>
      <form id="formNhanVien">
        <div class="form-grid">
          <div class="form-group"><label>Há» tÃªn</label><input type="text" id="nvHoTen" required /></div>
          <div class="form-group"><label>SÄT</label><input type="text" id="nvSdt" required /></div>
          <div class="form-group full"><label>Email</label><input type="email" id="nvEmail" required /></div>
          <div class="form-group full"><label>Äá»‹a chá»‰</label><input type="text" id="nvDiaChi" required /></div>
          <div class="form-group"><label>Giá»›i tÃ­nh</label>
            <select id="nvGioiTinh"><option value="">Chá»n</option><option>Nam</option><option>Ná»¯</option></select>
          </div>
          <div class="form-group"><label>Quyá»n</label>
            <select id="nvQuyen">
              <option value="nhanvien">NhÃ¢n viÃªn</option>
              <option value="admin">Admin</option>
              <option value="quanly">Quáº£n lÃ½</option>
            </select>
          </div>
          <div class="form-group"><label>Chá»©c vá»¥</label>
            <select id="nvChucVu">
              <option value="nhanvientt">NhÃ¢n viÃªn thá»±c táº­p</option>
              <option value="Admin">Admin</option>
              <option value="quanly">Quáº£n lÃ½</option>
              <option value="nhanvien">NhÃ¢n viÃªn</option>
            </select>
          </div>
          <div class="form-group"><label>TÃ¬nh tráº¡ng</label>
            <select id="nvTinhTrang"><option value="active">KÃ­ch hoáº¡t</option><option value="inactive">Ngá»«ng hoáº¡t Ä‘á»™ng</option></select>
          </div>
          <div class="form-group">
            <label for="nvKho">Kho lÃ m viá»‡c:</label>
            <select id="nvKho"><option value="">-- Chá»n kho lÃ m viá»‡c --</option></select>
          </div>
          <div class="form-group"><label><input type="checkbox" id="nvQuyenKho" /> Cáº¥p quyá»n quáº£n lÃ½ kho</label></div>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn-save">ğŸ’¾ LÆ°u</button>
          <button type="button" id="btnCancelNV" class="btn-cancel">âŒ Há»§y</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal thÃªm cá»­a hÃ ng -->
  <div id="modalAddCH" class="modal">
    <div class="modal-content">
      <h2>ğŸª ThÃªm cá»­a hÃ ng má»›i</h2>
      <form id="formCuaHang">
        <div class="form-grid">
          <div class="form-group full"><label>TÃªn cá»­a hÃ ng</label><input type="text" id="chTen" required /></div>
          <div class="form-group full"><label>Äá»‹a chá»‰</label><input type="text" id="chDiaChi" required /></div>
          <div class="form-group"><label>Tráº¡ng thÃ¡i</label>
            <select id="chTrangThai"><option value="active">KÃ­ch hoáº¡t</option><option value="inactive">Táº¡m dá»«ng</option></select>
          </div>
          <div class="form-group"><label>Quáº£n lÃ½ cá»­a hÃ ng</label>
            <select id="chQuanLy" required><option value="">-- Chá»n nhÃ¢n viÃªn quáº£n lÃ½ --</option></select>
          </div>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn-save">ğŸ’¾ LÆ°u</button>
          <button type="button" id="btnCancelCH" class="btn-cancel">âŒ Há»§y</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal danh sÃ¡ch cá»­a hÃ ng -->
  <div id="modalListCH" class="modal">
    <div class="modal-content" style="width:900px; max-height:90vh; overflow:auto;">
      <h2>ğŸ“‹ Danh sÃ¡ch cá»­a hÃ ng</h2>
      <div style="display:flex; gap:8px; margin-bottom:10px;">
        <input type="text" id="searchCH" placeholder="TÃ¬m theo tÃªn hoáº·c quáº£n lÃ½..."
               style="flex:1; padding:8px; border-radius:6px; border:1px solid #ccc;">
        <button id="btnSearchCH" class="btn-save">TÃ¬m</button>
        <button id="btnClearCH" class="btn-cancel">XÃ³a</button>
      </div>
      <table class="data-table">
        <thead>
          <tr><th>Store ID</th><th>TÃªn kho</th><th>Äá»‹a chá»‰</th><th>Quáº£n lÃ½</th><th>Tráº¡ng thÃ¡i</th><th>NgÃ y táº¡o</th><th>HÃ nh Ä‘á»™ng</th></tr>
        </thead>
        <tbody id="listCuaHang"></tbody>
      </table>
      <div class="modal-actions"><button id="btnCloseCH" class="btn-cancel">âŒ ÄÃ³ng</button></div>
    </div>
  </div>

  <!-- Modal khai bÃ¡o vá»‹ trÃ­ kho -->
  <div id="modalKhaiBaoVT" class="modal">
    <div class="modal-content" style="width:800px; max-height:90vh; overflow:auto;">
      <h2>ğŸ“¦ Khai bÃ¡o vá»‹ trÃ­ kho</h2>
      <form id="formViTriKho">
        <div class="form-grid">
          <div class="form-group full">
            <label>Chá»n kho Ä‘á»ƒ khai bÃ¡o</label>
            <select id="vtKhoSelect" required><option value="">-- Chá»n kho --</option></select>
          </div>
          <div class="form-group"><label>Khu</label><input type="text" id="vtKhu" placeholder="VD: A, B, C..." required /></div>
          <div class="form-group"><label>Ká»‡</label><input type="number" id="vtKe" min="1" required /></div>
          <div class="form-group"><label>Sá»‘ táº§ng/ká»‡</label><input type="number" id="vtTang" min="1" required /></div>
          <div class="form-group"><label>Sá»‘ vá»‹ trÃ­/táº§ng</label><input type="number" id="vtViTri" min="1" required /></div>
          <div class="form-group full"><label>Sá»‘ lÆ°á»£ng SP / vá»‹ trÃ­</label><input type="number" id="vtSoLuong" min="1" required /></div>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn-save">ğŸ’¾ LÆ°u</button>
          <button type="button" id="btnCancelVT" class="btn-cancel">âŒ ÄÃ³ng</button>
        </div>
      </form>

      <h3 style="margin-top:20px;">ğŸ“‹ Danh sÃ¡ch vá»‹ trÃ­ trong kho</h3>
      <table class="data-table vt-table">
        <thead>
          <tr>
            <th>Khu</th>
            <th>Ká»‡</th>
            <th>Táº§ng</th>
            <th>Vá»‹ trÃ­</th>
            <th>MÃ£</th>
            <th>Sá»‘ lÆ°á»£ng</th>
            <th>NgÃ y khai bÃ¡o</th>
            <th>HÃ nh Ä‘á»™ng</th>
          </tr>
        </thead>
        <tbody id="listViTriKho"></tbody>
      </table>
    </div>
  </div>
</body>
</html>
